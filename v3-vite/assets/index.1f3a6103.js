import{V as t,a as e}from"./index.6f40e3f2.js";import{t as s,i,e as o,a as r}from"./use-translate.ed5e29f0.js";import{c as n,b as a,s as l,g as c,w as d}from"./with-install.9958dc40.js";import{i as u}from"./style.c6c38aef.js";import{p as f}from"./event.7d40caae.js";import{u as p}from"./use-touch.3bbb1d83.js";import{u as m}from"./use-expose.ecdf2fa3.js";import{B as h,G as x,E as v,I as g,z as b,f as j,S as y,C,s as k,H as w,c as S,w as I,D as T,o as L,a as O,b as z,F as A,e as $,i as _,t as N}from"./vendor.ba7e37c4.js";import{u as R}from"./index.a4c0d7b1.js";import{u as B}from"./useChildren.6233e7a6.js";import{u as U}from"./index.6ba73617.js";import{u as V}from"./index.d9de3cd2.js";import{f as E}from"./constant.4d85ecb9.js";import{b as F}from"./unit.2a41fb1b.js";import{u as P}from"./useParent.7ddf7229.js";import{C as D}from"./index.d6d78035.js";import"./use-route.59eae6fc.js";import"./index.4b177ea8.js";import"./number.b01aa591.js";import"./on-popup-reopen.fc1de525.js";import"./utils.83cd68fa.js";import"./interceptor.29d0b3cc.js";import"./use-refs.3302cfeb.js";import"./index.6adc4e09.js";import"./index.667f321a.js";const[G,H]=n("index-bar"),M={sticky:s,zIndex:[Number,String],teleport:[String,Object],highlightColor:String,stickyOffsetTop:{type:Number,default:0},indexList:{type:Array,default:function(){const t="A".charCodeAt(0);return Array(26).fill("").map(((e,s)=>String.fromCharCode(t+s)))}}},X=Symbol(G);const Y=d(h({name:G,props:M,emits:["select","change"],setup(t,{emit:e,slots:s}){const o=x(),r=x(""),n=p(),d=R(o),{children:h,linkChildren:w}=B(X);w({props:t});const S=v((()=>{if(i(t.zIndex))return{zIndex:+t.zIndex+1}})),I=v((()=>{if(t.highlightColor)return{color:t.highlightColor}})),T=()=>{if(u(o))return;const{sticky:e,indexList:s}=t,i=a(d.value),n="getBoundingClientRect"in d.value?V(d):{top:0,left:0},l=h.map((t=>t.getRect(d.value,n))),c=((e,s)=>{for(let i=h.length-1;i>=0;i--){const o=i>0?s[i-1].height:0;if(e+(t.sticky?o+t.stickyOffsetTop:0)>=s[i].top)return i}return-1})(i,l);r.value=s[c],e&&h.forEach(((e,s)=>{const{state:o,$el:r}=e;if(s===c||s===c-1){const t=r.getBoundingClientRect();o.left=t.left,o.width=t.width}else o.left=null,o.width=null;if(s===c)o.active=!0,o.top=Math.max(t.stickyOffsetTop,l[s].top-i)+n.top;else if(s===c-1){const t=l[c].top-i;o.active=t>0,o.top=t+n.top-l[s].height}else o.active=!1}))},L=()=>k(T);U("scroll",T,{target:d}),g(L),b((()=>t.indexList),L),b(r,(t=>{t&&e("change",t)}));const O=s=>{s=String(s);const i=h.find((t=>String(t.index)===s));i&&(i.$el.scrollIntoView(),t.sticky&&t.stickyOffsetTop&&l(c()-t.stickyOffsetTop),e("select",i.index))},z=t=>{const{index:e}=t.dataset;e&&O(e)},A=t=>{z(t.target)};let $;const _=t=>{if(n.move(t),n.isVertical()){f(t);const{clientX:e,clientY:s}=t.touches[0],i=document.elementFromPoint(e,s);if(i){const{index:t}=i.dataset;t&&$!==t&&($=t,z(i))}}},N=()=>j("div",{class:H("sidebar"),style:S.value,onClick:A,onTouchstart:n.start,onTouchmove:_},[t.indexList.map((t=>{const e=t===r.value;return j("span",{class:H("index",{active:e}),style:e?I.value:void 0,"data-index":t},[t])}))]);return m({scrollTo:O}),()=>{var e;let i;return j("div",{ref:o,class:H()},[t.teleport?j(y,{to:t.teleport},(r=i=N(),"function"==typeof r||"[object Object]"===Object.prototype.toString.call(r)&&!C(r)?i:{default:()=>[i]})):N(),null==(e=s.default)?void 0:e.call(s)]);var r}}})),[q,J]=n("index-anchor");const K=d(h({name:q,props:{index:[Number,String]},setup(t,{slots:e}){const s=w({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),i=x(),{parent:r}=P(X);if(!r)return;const n=()=>s.active&&r.props.sticky,l=v((()=>{const{zIndex:t,highlightColor:e}=r.props;if(n())return o(F(t),{left:s.left?`${s.left}px`:void 0,width:s.width?`${s.width}px`:void 0,transform:s.top?`translate3d(0, ${s.top}px, 0)`:void 0,color:e})}));return m({state:s,getRect:(t,e)=>{const o=V(i);return s.rect.height=o.height,t===window||t===document.body?s.rect.top=o.top+c():s.rect.top=o.top+a(t)-e.top,s.rect}}),()=>{const o=n();return j("div",{ref:i,style:{height:o?`${s.rect.height}px`:void 0}},[j("div",{style:l.value,class:[J({sticky:o}),{[E]:o}]},[e.default?e.default():t.index])])}}}));var Q=h({setup(s){const i=r({"zh-CN":{text:"文本",customIndexList:"自定义索引列表"},"en-US":{text:"Text",customIndexList:"Custom Index List"}}),o=x(0),n=[],a=[1,2,3,4,5,6,8,9,10],l="A".charCodeAt(0);for(let t=0;t<26;t++)n.push(String.fromCharCode(l+t));return(s,r)=>(L(),S(T(t),{active:o.value,"onUpdate:active":r[0]||(r[0]=t=>o.value=t)},{default:I((()=>[j(T(e),{title:T(i)("basicUsage")},{default:I((()=>[j(T(Y),null,{default:I((()=>[(L(),O(A,null,z(n,(t=>$("div",{key:t},[j(T(K),{index:t},null,8,["index"]),j(T(D),{title:T(i)("text")},null,8,["title"]),j(T(D),{title:T(i)("text")},null,8,["title"]),j(T(D),{title:T(i)("text")},null,8,["title"])]))),64))])),_:1})])),_:1},8,["title"]),j(T(e),{title:T(i)("customIndexList")},{default:I((()=>[j(T(Y),{"index-list":a},{default:I((()=>[(L(),O(A,null,z(a,(t=>$("div",{key:t},[j(T(K),{index:t},{default:I((()=>[_(N(T(i)("title")+t),1)])),_:2},1032,["index"]),j(T(D),{title:T(i)("text")},null,8,["title"]),j(T(D),{title:T(i)("text")},null,8,["title"]),j(T(D),{title:T(i)("text")},null,8,["title"])]))),64))])),_:1})])),_:1},8,["title"])])),_:1},8,["active"]))}});export{Q as default};
