import{u as e,V as i,a as r}from"./index.6f40e3f2.js";import{t,a as o}from"./use-translate.ed5e29f0.js";import{c as s,w as a}from"./with-install.9958dc40.js";import{i as n}from"./style.c6c38aef.js";import{u as l}from"./use-expose.ecdf2fa3.js";import{L as d}from"./index.e2ba8582.js";import{B as f,G as u,z as m,Z as h,I as p,f as c,s as g,c as v,w as x,D as j,o as b,a as T,b as k,F as _}from"./vendor.ba7e37c4.js";import{u as y}from"./index.a4c0d7b1.js";import{u as C}from"./index.6ba73617.js";import{u as S}from"./index.d9de3cd2.js";import{C as U}from"./index.d6d78035.js";import{P as R}from"./index.c23d7130.js";import"./use-route.59eae6fc.js";import"./index.4b177ea8.js";import"./event.7d40caae.js";import"./number.b01aa591.js";import"./use-touch.3bbb1d83.js";import"./on-popup-reopen.fc1de525.js";import"./utils.83cd68fa.js";import"./useChildren.6233e7a6.js";import"./useParent.7ddf7229.js";import"./constant.4d85ecb9.js";import"./interceptor.29d0b3cc.js";import"./unit.2a41fb1b.js";import"./use-refs.3302cfeb.js";import"./index.6adc4e09.js";import"./index.667f321a.js";const[w,I,B]=s("list");const L=a(f({name:w,props:{error:Boolean,loading:Boolean,finished:Boolean,errorText:String,loadingText:String,finishedText:String,immediateCheck:t,offset:{type:[Number,String],default:300},direction:{type:String,default:"down"}},emits:["load","update:error","update:loading"],setup(i,{emit:r,slots:t}){const o=u(!1),s=u(),a=u(),f=e(),v=y(s),x=()=>{g((()=>{if(o.value||i.finished||i.error||!1===(null==f?void 0:f.value))return;const{offset:e,direction:t}=i,l=S(v);if(!l.height||n(s))return;let d=!1;const u=S(a);d="up"===t?l.top-u.top<=e:u.bottom-l.bottom<=e,d&&(o.value=!0,r("update:loading",!0),r("load"))}))},j=()=>{if(i.finished){const e=t.finished?t.finished():i.finishedText;if(e)return c("div",{class:I("finished-text")},[e])}},b=()=>{r("update:error",!1),x()},T=()=>{if(i.error){const e=t.error?t.error():i.errorText;if(e)return c("div",{class:I("error-text"),onClick:b},[e])}},k=()=>{if(o.value&&!i.finished)return c("div",{class:I("loading")},[t.loading?t.loading():c(d,{class:I("loading-icon")},{default:()=>[i.loadingText||B("loading")]})])};return m([()=>i.loading,()=>i.finished,()=>i.error],x),f&&m(f,(e=>{e&&x()})),h((()=>{o.value=i.loading})),p((()=>{i.immediateCheck&&x()})),l({check:x}),C("scroll",x,{target:v}),()=>{var e;const r=null==(e=t.default)?void 0:e.call(t),n=c("div",{ref:a,class:I("placeholder")},null);return c("div",{ref:s,role:"feed",class:I(),"aria-busy":o.value},["down"===i.direction?r:n,k(),j(),T(),"up"===i.direction?r:n])}}}));var V=f({setup(e){const t=o({"zh-CN":{errorInfo:"错误提示",errorText:"请求失败，点击重新加载",pullRefresh:"下拉刷新",finishedText:"没有更多了"},"en-US":{errorInfo:"Error Info",errorText:"Request failed. Click to reload",pullRefresh:"PullRefresh",finishedText:"Finished"}}),s=u([{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1},{items:[],refreshing:!1,loading:!1,error:!1,finished:!1}]),a=e=>{const i=s.value[e];i.loading=!0,setTimeout((()=>{i.refreshing&&(i.items=[],i.refreshing=!1);for(let e=0;e<10;e++){const e=i.items.length+1;i.items.push(e<10?"0"+e:String(e))}i.loading=!1,i.refreshing=!1,1!==e||10!==i.items.length||i.error?i.error=!1:i.error=!0,i.items.length>=40&&(i.finished=!0)}),1e3)};return(e,o)=>(b(),v(j(i),null,{default:x((()=>[c(j(r),{title:j(t)("basicUsage")},{default:x((()=>[c(j(L),{loading:s.value[0].loading,"onUpdate:loading":o[0]||(o[0]=e=>s.value[0].loading=e),finished:s.value[0].finished,"finished-text":j(t)("finishedText"),onLoad:o[1]||(o[1]=e=>a(0))},{default:x((()=>[(b(!0),T(_,null,k(s.value[0].items,(e=>(b(),v(j(U),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["title"]),c(j(r),{title:j(t)("errorInfo")},{default:x((()=>[c(j(L),{loading:s.value[1].loading,"onUpdate:loading":o[2]||(o[2]=e=>s.value[1].loading=e),error:s.value[1].error,"onUpdate:error":o[3]||(o[3]=e=>s.value[1].error=e),finished:s.value[1].finished,"error-text":j(t)("errorText"),onLoad:o[4]||(o[4]=e=>a(1))},{default:x((()=>[(b(!0),T(_,null,k(s.value[1].items,(e=>(b(),v(j(U),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","error","finished","error-text"])])),_:1},8,["title"]),c(j(r),{title:j(t)("pullRefresh")},{default:x((()=>[c(j(R),{modelValue:s.value[2].refreshing,"onUpdate:modelValue":o[7]||(o[7]=e=>s.value[2].refreshing=e),onRefresh:o[8]||(o[8]=e=>{return i=2,s.value[i].finished=!1,void a(i);var i})},{default:x((()=>[c(j(L),{loading:s.value[2].loading,"onUpdate:loading":o[5]||(o[5]=e=>s.value[2].loading=e),finished:s.value[2].finished,"finished-text":j(t)("finishedText"),onLoad:o[6]||(o[6]=e=>a(2))},{default:x((()=>[(b(!0),T(_,null,k(s.value[2].items,(e=>(b(),v(j(U),{key:e,title:e},null,8,["title"])))),128))])),_:1},8,["loading","finished","finished-text"])])),_:1},8,["modelValue"])])),_:1},8,["title"])])),_:1}))}});export{V as default};
