import{e as t,u as o,t as e,p as n,m as l,b as s}from"./use-translate.ed5e29f0.js";import{c as a,w as c}from"./with-install.9958dc40.js";import{m as r,u as i}from"./mount-component.858fa0c4.js";import{a as u,b as m}from"./constant.4d85ecb9.js";import{c as f}from"./interceptor.29d0b3cc.js";import{a as d}from"./unit.2a41fb1b.js";import{a as p,p as g,P as B}from"./index.03bd3dc3.js";import{B as C}from"./index.4d75283b.js";import{b,a as w}from"./index.e3db815a.js";import{B as h,H as v,f as x,L as y}from"./vendor.ba7e37c4.js";const[O,k,S]=a("dialog"),j=[...p,"transition","closeOnPopstate"];var T=h({name:O,props:t({},g,{title:String,theme:String,width:[Number,String],message:[String,Function],callback:Function,allowHtml:Boolean,className:o,messageAlign:String,closeOnPopstate:e,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showConfirmButton:e,closeOnClickOverlay:Boolean,transition:{type:String,default:"van-dialog-bounce"}}),emits:["confirm","cancel","update:show"],setup(t,{emit:o,slots:e}){const s=v({confirm:!1,cancel:!1}),a=t=>o("update:show",t),c=o=>{a(!1),t.callback&&t.callback(o)},r=e=>()=>{t.show&&(o(e),t.beforeClose?(s[e]=!0,f({interceptor:t.beforeClose,args:[e],done(){c(e),s[e]=!1},canceled(){s[e]=!1}})):c(e))},i=r("cancel"),p=r("confirm"),g=()=>{const o=e.title?e.title():t.title;if(o)return x("div",{class:k("header",{isolated:!t.message&&!e.default})},[o])},h=o=>{const{message:e,allowHtml:n,messageAlign:s}=t,a=k("message",{"has-title":o,[s]:s}),c=l(e)?e():e;return n&&"string"==typeof c?x("div",{class:a,innerHTML:c},null):x("div",{class:a},[c])},O=()=>{if(e.default)return x("div",{class:k("content")},[e.default()]);const{title:o,message:n,allowHtml:l}=t;if(n){const t=!(!o&&!e.title);return x("div",{key:l?1:0,class:k("content",{isolated:!t})},[h(t)])}},T=()=>e.footer?e.footer():"round-button"===t.theme?x(w,{class:k("footer")},{default:()=>[t.showCancelButton&&x(b,{type:"warning",text:t.cancelButtonText||S("cancel"),class:k("cancel"),color:t.cancelButtonColor,loading:s.cancel,onClick:i},null),t.showConfirmButton&&x(b,{type:"danger",text:t.confirmButtonText||S("confirm"),class:k("confirm"),color:t.confirmButtonColor,loading:s.confirm,onClick:p},null)]}):x("div",{class:[m,k("footer")]},[t.showCancelButton&&x(C,{size:"large",text:t.cancelButtonText||S("cancel"),class:k("cancel"),style:{color:t.cancelButtonColor},loading:s.cancel,onClick:i},null),t.showConfirmButton&&x(C,{size:"large",text:t.confirmButtonText||S("confirm"),class:[k("confirm"),{[u]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:s.confirm,onClick:p},null)]);return()=>{const{width:o,title:e,theme:l,message:s,className:c}=t;return x(B,y({role:"dialog",class:[k([l]),c],style:{width:d(o)},"aria-labelledby":e||s},n(t,j),{"onUpdate:show":a}),{default:()=>[g(),O(),T()]})}}});let P;function H(o){return s?new Promise(((e,n)=>{P||function(){const t={setup(){const{state:t,toggle:o}=i();return()=>x(T,y(t,{"onUpdate:show":o}),null)}};({instance:P}=r(t))}(),P.open(t({},H.currentOptions,o,{callback:t=>{("confirm"===t?e:n)(t)}}))})):Promise.resolve()}H.defaultOptions={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1},H.currentOptions=t({},H.defaultOptions),H.alert=H,H.confirm=o=>H(t({showCancelButton:!0},o)),H.close=()=>{P&&P.toggle(!1)},H.setDefaultOptions=o=>{t(H.currentOptions,o)},H.resetDefaultOptions=()=>{H.currentOptions=t({},H.defaultOptions)},H.Component=c(T),H.install=t=>{t.use(H.Component),t.config.globalProperties.$dialog=H};export{H as D};
